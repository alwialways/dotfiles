# Sidebar Patch --------------------------------------
#set sidebar_delim   = '  │'
set sidebar_visible = yes
set sidebar_width   = 24
color sidebar_new color221 color233

# Sidebar Navigation ---------------------------------
bind index,pager <down>   sidebar-next
bind index,pager <up>     sidebar-prev
bind index,pager <right>  sidebar-open
bind index,pager b sidebar-toggle-visible # b toggles sidebar visibility
set index_format="%4C %Z %?X?A&-? %{%d/%b/%y} %-12.12L %?M?(#%03M)&(%4c)? %?y?(%.20Y) ?%s"

# Status Bar -----------------------------------------
set status_chars  = " *%A"
set status_format = "───[ Folder: %f ]───[%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]───%>─%?p?( %p postponed )?───"

# Header Options -------------------------------------
ignore *                                # ignore all headers
unignore from: to: cc: date: subject:   # show only these
unhdr_order *                           # some distros order things by default
hdr_order from: to: cc: date: subject:  # and in this order

# Account Settings -----------------------------------

#set wait_key = no        # shut up, mutt
#set timeout = 3          # idle time before scanning
#set mail_check = 0       # minimum time between scans
#unset move               # gmail does that
set beep_new              # bell on new mails
#set pipe_decode          # strip headers and eval mimes when piping
#set thorough_search      # strip headers and eval mimes before searching

## Speed up folder switch
set sleep_time = 0
set mbox_type=Maildir
#set imap_check_subscribed

set folder = "~/Mail"
set spoolfile = "+Gmail/INBOX"
source ~/.mutt/mailboxes

## Not much
#set virtual_spoolfile=yes
#set nm_default_uri="notmuch:///home/arch/Mail" # path to the maildir
#source ~/.mutt/virtualmailboxes

macro index <F8> \
     "<enter-command>unset wait_key<enter><shell-escape>notmuch-mutt --prompt search<enter><change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter>" \
     "notmuch: search mail"
macro index <F9> \
     "<enter-command>unset wait_key<enter><pipe-message>notmuch-mutt thread<enter><change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter><enter-command>set wait_key<enter>" \
     "notmuch: reconstruct thread"
macro index <F6> \
     "<enter-command>unset wait_key<enter><pipe-message>notmuch-mutt tag -inbox<enter>" \
     "notmuch: remove message from inbox"

macro index A "<modify-labels>+archive -unread -inbox\\n" "Archive message"
macro index c "<change-vfolder>?" "Change to vfolder overview"
macro index \\\\ "<vfolder-from-query>" "Search mailbox"

macro generic "<esc>1" ":set from=felipebrokate@gmail.com realname='Cristian'"
macro generic "<esc>2" ":set from=cristian.perez-brokate@chimie-paristech.fr realname='Cristian PEREZ'"

## Default account
## Here we use the $folder variable that has just been set in the sourced file.
## We must set it right now otherwise the 'folder' variable will change in the next sourced file.
folder-hook 'Chimie/*' 'source ~/.mutt/account_chimie'
folder-hook 'Gmail/*' 'source ~/.mutt/account_gmail'
folder-hook 'Kernix/*' 'source ~/.mutt/account_kernix'

macro index <F4> '<sync-mailbox><enter-command>source +Gmail/* <enter><change-folder>!<enter>'
macro index <F3> '<sync-mailbox><enter-command>source +Chimie/* <enter><change-folder>!<enter>'

# Default account
source "~/.mutt/account_gmail"

## Mailcap
set mailcap_path	= ~/.mutt/mailcap
alternative_order text/plain text/html
auto_view text/html
auto_view text/calendar application/ics
set markers=no # Delete the + sign on new lines

set print_command="~/Documents/Script/mutt_print.sh"

## Sorting index by thread
#set sort=threads #sort by threads
#set sort_aux = last-date-received

## Security
source /usr/share/doc/mutt/samples/gpg.rc
#set pgp_use_gpg_agent = yes
set pgp_timeout        = 3600       # how long to cache the pass-phrase
#set crypt_autosign     = yes     # automatically sign all outgoing mail
#set crypt_replyencrypt = yes # automatically encrypt replies to  encrypted messages
set pgp_sign_as        = "B212E65B"   # my Key ID

## Paths
source ~/.mutt/mutt-colors-solarized-dark-256.muttrc
source ~/.mutt/alias
set alias_file = ~/.mutt/alias # where to store aliases
